service: tile-broker-lambda
frameworkVersion: '3'

plugins:
  - serverless-plugin-typescript
  - serverless-offline
provider:
  name: aws
  runtime: nodejs14.x

functions:
  app:
    handler: index.handler
    environment:
      AWS_REGION: us-east-1
      S3_BUCKET: image-tile-mart
      S3_PATH_TILE_CACHE: tile-cache
      S3_PATH_STYLE_CONFIG: style-config
    events:
      - http: 'ANY /'

  fetchTile:
    handler: index.handler
    events:
      - http: 'GET /tiles/{tilesetId}/{z}/{x}/{y}.png'
